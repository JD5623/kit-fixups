From a3a98a6d83dfbf49f565f5aa2d7c07153a7f62fc Mon Sep 17 00:00:00 2001
From: Albert Astals Cid <aacid@kde.org>
Date: Wed, 21 Jun 2017 00:55:20 +0200
Subject: Fix crash in malformed documents


Index: poppler-0.48.0/poppler/JBIG2Stream.cc
===================================================================
--- poppler-0.48.0.orig/poppler/JBIG2Stream.cc
+++ poppler-0.48.0/poppler/JBIG2Stream.cc
@@ -892,7 +892,7 @@ void JBIG2Bitmap::combine(JBIG2Bitmap *b
   oneByte = x0 == ((x1 - 1) & ~7);
 
   for (yy = y0; yy < y1; ++yy) {
-    if (unlikely(y + yy) >= h)
+    if (unlikely((y + yy >= h) || (y + yy < 0)))
       continue;
 
     // one byte per line -- need to mask both left and right side
